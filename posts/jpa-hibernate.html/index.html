<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>JPA/Hibernate问题汇总 - Yulin Lewis' Blog</title><meta name=keywords content="雨临Lewis,Java,hugo,hexo,博客"><meta name=Description content="不想当写手的码农不是好咸鱼_(xз」∠)_"><meta property="og:title" content="JPA/Hibernate问题汇总"><meta property="og:description" content="懒加载异常 - JsonMappingException: could not initialize proxy
查询数据时报懒加载异常：


1
2
3
4
5


Caused by: org.hibernate.LazyInitializationException: could not initialize proxy [com.cbxsoftware.cbx.attachment.entity.RefAttachment#c109ec36e60c4a89a10eabc72416d984] - no Session
	at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:169)
	at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:309)
	at org.hibernate.proxy.pojo.bytebuddy.ByteBuddyInterceptor.intercept(ByteBuddyInterceptor.java:45)
	at org.hibernate.proxy.ProxyConfiguration$InterceptorDispatcher.intercept(ProxyConfiguration.java:95)"><meta property="og:type" content="article"><meta property="og:url" content="https://lewky.cn/posts/jpa-hibernate.html/"><meta property="og:image" content="https://lewky.cn/logo.png"><meta property="article:published_time" content="2021-04-01T00:07:30+08:00"><meta property="article:modified_time" content="2021-04-01T00:07:30+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://lewky.cn/logo.png"><meta name=twitter:title content="JPA/Hibernate问题汇总"><meta name=twitter:description content="懒加载异常 - JsonMappingException: could not initialize proxy
查询数据时报懒加载异常：


1
2
3
4
5


Caused by: org.hibernate.LazyInitializationException: could not initialize proxy [com.cbxsoftware.cbx.attachment.entity.RefAttachment#c109ec36e60c4a89a10eabc72416d984] - no Session
	at org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:169)
	at org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:309)
	at org.hibernate.proxy.pojo.bytebuddy.ByteBuddyInterceptor.intercept(ByteBuddyInterceptor.java:45)
	at org.hibernate.proxy.ProxyConfiguration$InterceptorDispatcher.intercept(ProxyConfiguration.java:95)"><meta name=application-name content="雨临Lewis的博客"><meta name=apple-mobile-web-app-title content="雨临Lewis的博客"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://lewky.cn/posts/jpa-hibernate.html/><link rel=prev href=https://lewky.cn/posts/docsify-0.html/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"JPA/Hibernate问题汇总","inLanguage":"","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/lewky.cn\/posts\/jpa-hibernate.html\/"},"genre":"posts","keywords":"JPA, Hibernate, 懒加载","wordcount":2556,"url":"https:\/\/lewky.cn\/posts\/jpa-hibernate.html\/","datePublished":"2021-04-01T00:07:30+08:00","dateModified":"2021-04-01T00:07:30+08:00","license":"This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher":{"@type":"Organization","name":"雨临Lewis","logo":"https:\/\/lewky.cn\/images\/avatar.jpg"},"author":{"@type":"Person","name":"雨临Lewis"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':('auto'==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:'auto'==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><a href=https://github.com/lewky class=github-corner target=_blank title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="3.5rem" height="3.5rem" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div class=header-title><a href=/ title="Yulin Lewis' Blog"><span class=header-title-pre><i class="fas fa-fw fa-atom"></i></span>雨临Lewis</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/><i class="fas fa-fw fa-archive"></i>归档 </a><a class=menu-item href=/tags/><i class="fas fa-fw fa-tag"></i>标签 </a><a class=menu-item href=/categories/><i class="fas fa-fw fa-th"></i>分类 </a><a class=menu-item href=/about/><i class="fas fa-fw fa-at"></i>关于 </a><a class=menu-item href=/friends/><i class="fas fa-fw fa-fan fa-spin"></i>友链 </a><a class=menu-item href=/search/><i class="fas fa-fw fa-search"></i>搜索 </a><a href=javascript:void(0); class="menu-item language" title=更多><i class="fa fa-fw fa-angle-double-down"></i>更多
<select class=menu-more id=language-select-desktop onchange="location=this.value;">
<option class=placeholder>------</option><option value=/bbs/><i class="fas fa-fw fa-fan fa-spin"></i> BBS </option><option value=https://javanote.doc.lewky.cn/><i class="fas fa-fw fa-fan fa-spin"></i>JavaNote</option></select>
</a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Yulin Lewis' Blog"><span class=header-title-pre><i class="fas fa-fw fa-atom"></i></span>雨临Lewis</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/><i class="fas fa-fw fa-archive"></i>归档</a><a class=menu-item href=/tags/><i class="fas fa-fw fa-tag"></i>标签</a><a class=menu-item href=/categories/><i class="fas fa-fw fa-th"></i>分类</a><a class=menu-item href=/about/><i class="fas fa-fw fa-at"></i>关于</a><a class=menu-item href=/friends/><i class="fas fa-fw fa-fan fa-spin"></i>友链</a><a class=menu-item href=/search/><i class="fas fa-fw fa-search"></i>搜索</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a><a href=javascript:void(0); class="menu-item language" title=更多><i class="fa fa-angle-double-down"></i>更多
<select class=menu-more id=language-select-desktop onchange="location=this.value;">
<option class=placeholder>------</option><option value=/bbs/><i class="fas fa-fw fa-fan fa-spin"></i> BBS </option><option value=https://javanote.doc.lewky.cn/><i class="fas fa-fw fa-fan fa-spin"></i>JavaNote</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">JPA/Hibernate问题汇总</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>雨临Lewis</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/java/><i class="far fa-folder fa-fw"></i>Java</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-04-01>2021-04-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2556 字
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 6 分钟&nbsp;<span id=/posts/jpa-hibernate.html/ class=leancloud_visitors data-flag-title=JPA/Hibernate问题汇总>
<i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
</span>&nbsp;
<a href=#comments id=post-meta-vcount title=查看评论><i class="fas fa-comment fa-fw"></i>&nbsp;<span id=/posts/jpa-hibernate.html/ class=waline-comment-count></span>&nbsp;条评论</a></div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#懒加载异常---jsonmappingexception-could-not-initialize-proxy>懒加载异常 - JsonMappingException: could not initialize proxy</a><ol><li><a href=#解决方法一>解决方法一</a></li><li><a href=#解决方法二>解决方法二</a></li><li><a href=#懒加载源码分析>懒加载源码分析</a></li></ol></li><li><a href=#joincolumn注解无法找回数据导致报错>@JoinColumn注解无法找回数据导致报错</a></li><li><a href=#参考链接>参考链接</a></li></ol></nav></div></div><div class=content id=content><h2 id=懒加载异常---jsonmappingexception-could-not-initialize-proxy>懒加载异常 - JsonMappingException: could not initialize proxy</h2><p>查询数据时报懒加载异常：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=n>Caused</span> <span class=n>by</span><span class=o>:</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>LazyInitializationException</span><span class=o>:</span> <span class=n>could</span> <span class=n>not</span> <span class=n>initialize</span> <span class=n>proxy</span> <span class=o>[</span><span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>cbx</span><span class=o>.</span><span class=na>attachment</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>RefAttachment</span><span class=err>#</span><span class=n>c109ec36e60c4a89a10eabc72416d984</span><span class=o>]</span> <span class=o>-</span> <span class=n>no</span> <span class=n>Session</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>AbstractLazyInitializer</span><span class=o>.</span><span class=na>initialize</span><span class=o>(</span><span class=n>AbstractLazyInitializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>169</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>AbstractLazyInitializer</span><span class=o>.</span><span class=na>getImplementation</span><span class=o>(</span><span class=n>AbstractLazyInitializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>309</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>pojo</span><span class=o>.</span><span class=na>bytebuddy</span><span class=o>.</span><span class=na>ByteBuddyInterceptor</span><span class=o>.</span><span class=na>intercept</span><span class=o>(</span><span class=n>ByteBuddyInterceptor</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>45</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>ProxyConfiguration$InterceptorDispatcher</span><span class=o>.</span><span class=na>intercept</span><span class=o>(</span><span class=n>ProxyConfiguration</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>95</span><span class=o>)</span>
</code></pre></td></tr></table></div></div><p>报错很明显，是由于hibernate的懒加载引起的。项目使用的是SpringBoot框架，JPA默认使用的是hibernate的实现，而hibernate的懒加载机制其实就是延迟加载对象，如果没有在session关闭前使用到对象里除id以外的属性时，就只会返回一个没有初始化过的包含了id的代理类。很多时候，这个代理类会引发上述的异常。</p><p>简单说一下为什么会触发懒加载异常，首先hibernate开启一个session（会话），然后开启transaction（事务），接着发出sql找回数据并组装成pojo（或者说entity、model），这时候如果pojo里有懒加载的对象，并不会去发出sql查询db，而是直接返回一个懒加载的代理对象，这个对象里只有id。</p><p>如果接下来没有其他的操作去访问这个代理对象除了id以外的属性，就不会去初始化这个代理对象，也就不会去发出sql查找db。接着事务提交，session关闭。如果这时候再去访问代理对象除了id以外的属性时，就会报上述的懒加载异常，原因是这时候已经没有session了，无法初始化懒加载的代理对象。</p><h3 id=解决方法一>解决方法一</h3><p>如果是spring继承的hibernate，根据上述的原因，可以延长session的生命周期，但是这里用的是SpringBoot的JPA，处理方法不同，需要在<code>application.properties</code>配置下懒加载相关的东西：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-xml data-lang=xml>spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true
</code></pre></td></tr></table></div></div><p>进行该配置后，可以在session关闭时也能另外开启一个新的session和事务来访问db以取回懒加载对象的数据。</p><h3 id=解决方法二>解决方法二</h3><p>因为该懒加载异常是缺少session导致的，那么可以通过在方法前添加事务注解<code>@Transactional</code>的方式来解决，只要事务没有提交，session就不会关闭，自然就不会出现上述的懒加载异常。不过由于该事务注解是用Spring AOP实现的，存在着一些坑，比如类内直接调用无效或者对非public方法无效等，需要多加注意。</p><p>当使用了上述两种方法后，发现不再触发<code>LazyInitializationException</code>，但是却发生了另一个新的异常<code>InvalidDefinitionException</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>exc</span><span class=o>.</span><span class=na>InvalidDefinitionException</span><span class=o>:</span> <span class=n>No</span> <span class=n>serializer</span> <span class=n>found</span> <span class=k>for</span> <span class=kd>class</span> <span class=nc>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>pojo</span><span class=o>.</span><span class=na>bytebuddy</span><span class=o>.</span><span class=na>ByteBuddyInterceptor</span> <span class=n>and</span> <span class=n>no</span> <span class=n>properties</span> <span class=n>discovered</span> <span class=n>to</span> <span class=n>create</span> <span class=nf>BeanSerializer</span> <span class=o>(</span><span class=n>to</span> <span class=n>avoid</span> <span class=n>exception</span><span class=o>,</span> <span class=n>disable</span> <span class=n>SerializationFeature</span><span class=o>.</span><span class=na>FAIL_ON_EMPTY_BEANS</span><span class=o>)</span> <span class=o>(</span><span class=n>through</span> <span class=n>reference</span> <span class=n>chain</span><span class=o>:</span> <span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>cbx</span><span class=o>.</span><span class=na>item</span><span class=o>.</span><span class=na>elasticsearch</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>ItemEstc</span><span class=o>[</span><span class=s>&#34;mainEntity&#34;</span><span class=o>]-&gt;</span><span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>cbx</span><span class=o>.</span><span class=na>item</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>Item</span><span class=o>[</span><span class=s>&#34;image&#34;</span><span class=o>]-&gt;</span><span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>cbx</span><span class=o>.</span><span class=na>image</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>RefImage</span><span class=o>[</span><span class=s>&#34;propFormat&#34;</span><span class=o>]-&gt;</span><span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>cbx</span><span class=o>.</span><span class=na>attachment</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>RefAttachment$HibernateProxy$vTKSYzrN</span><span class=o>[</span><span class=s>&#34;hibernateLazyInitializer&#34;</span><span class=o>])</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>exc</span><span class=o>.</span><span class=na>InvalidDefinitionException</span><span class=o>.</span><span class=na>from</span><span class=o>(</span><span class=n>InvalidDefinitionException</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>77</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>SerializerProvider</span><span class=o>.</span><span class=na>reportBadDefinition</span><span class=o>(</span><span class=n>SerializerProvider</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>1191</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>DatabindContext</span><span class=o>.</span><span class=na>reportBadDefinition</span><span class=o>(</span><span class=n>DatabindContext</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>313</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>ser</span><span class=o>.</span><span class=na>impl</span><span class=o>.</span><span class=na>UnknownSerializer</span><span class=o>.</span><span class=na>failForEmpty</span><span class=o>(</span><span class=n>UnknownSerializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>71</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>ser</span><span class=o>.</span><span class=na>impl</span><span class=o>.</span><span class=na>UnknownSerializer</span><span class=o>.</span><span class=na>serialize</span><span class=o>(</span><span class=n>UnknownSerializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>33</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>ser</span><span class=o>.</span><span class=na>BeanPropertyWriter</span><span class=o>.</span><span class=na>serializeAsField</span><span class=o>(</span><span class=n>BeanPropertyWriter</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>727</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>com</span><span class=o>.</span><span class=na>fasterxml</span><span class=o>.</span><span class=na>jackson</span><span class=o>.</span><span class=na>databind</span><span class=o>.</span><span class=na>ser</span><span class=o>.</span><span class=na>std</span><span class=o>.</span><span class=na>BeanSerializerBase</span><span class=o>.</span><span class=na>serializeFields</span><span class=o>(</span><span class=n>BeanSerializerBase</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>719</span><span class=o>)</span>
	<span class=o>...</span>
</code></pre></td></tr></table></div></div><p>这个异常是由于hibernate在代理类里添加了一个属性<code>hibernateLazyInitializer</code>，当该对象转换成json的时候就会报错。解决方法是将该属性过滤掉，可以在对应的类名或者公共类前加上如下注解：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=nd>@JsonIgnoreProperties</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=o>{</span> <span class=s>&#34;hibernateLazyInitializer&#34;</span> <span class=o>})</span>
</code></pre></td></tr></table></div></div><h3 id=懒加载源码分析>懒加载源码分析</h3><p>因为对懒加载异常的发生有些好奇，所以看了下hibernate的源码，这里简单分析下，另外我看的是两个源码包如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>spring-orm-5.1.5.RELEASE.jar
hibernate-core-5.3.7.Final.jar
</code></pre></td></tr></table></div></div><p>首先是关于<code>spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true</code>的配置，前面半截是因为JPA集成了hibernate的配置，所以在hibernate中，这个配置应该是<code>hibernate.enable_lazy_load_no_trans=true</code>。</p><p>在hibernate的一个常量接口<code>org.hibernate.cfg.AvailableSettings</code>中定义了各种配置常量，其中就包括上述这个配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=n>String</span> <span class=n>ENABLE_LAZY_LOAD_NO_TRANS</span> <span class=o>=</span> <span class=s>&#34;hibernate.enable_lazy_load_no_trans&#34;</span><span class=o>;</span>
</code></pre></td></tr></table></div></div><p>在启动项目的时候会读取配置文件，将其解析为一个<code>HashMap&lt;K,V></code>，这些参数在new<code>EntityManagerFactoryBuilderImpl</code>的时候被使用到，上面的常量会在<code>org.hibernate.boot.internal.SessionFactoryOptionsBuilder</code>里被拿来初始化：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=k>this</span><span class=o>.</span><span class=na>initializeLazyStateOutsideTransactions</span> <span class=o>=</span> <span class=n>cfgService</span><span class=o>.</span><span class=na>getSetting</span><span class=o>(</span> <span class=n>ENABLE_LAZY_LOAD_NO_TRANS</span><span class=o>,</span> <span class=n>BOOLEAN</span><span class=o>,</span> <span class=kc>false</span> <span class=o>);</span>
</code></pre></td></tr></table></div></div><p>因为在配置文件里配置了该变量的值为true，所以这里在初始化的时候就会把<code>initializeLazyStateOutsideTransactions</code>的值设置为true。该变量由一个方法来判断其值是否为true：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java>	<span class=nd>@Override</span>
	<span class=kd>public</span> <span class=kt>boolean</span> <span class=nf>isInitializeLazyStateOutsideTransactionsEnabled</span><span class=o>()</span> <span class=o>{</span>
		<span class=k>return</span> <span class=n>initializeLazyStateOutsideTransactions</span><span class=o>;</span>
	<span class=o>}</span>
</code></pre></td></tr></table></div></div><p>接着在组装pojo时，会为懒加载对象创建对应的代理对象，当需要获取该代理对象除id以外的属性时，就会调用<code>AbstractLazyInitializer#initialize()</code>进行初始化，逻辑如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java>	<span class=nd>@Override</span>
	<span class=kd>public</span> <span class=kd>final</span> <span class=kt>void</span> <span class=nf>initialize</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>HibernateException</span> <span class=o>{</span>
		<span class=k>if</span> <span class=o>(</span> <span class=o>!</span><span class=n>initialized</span> <span class=o>)</span> <span class=o>{</span>
			<span class=k>if</span> <span class=o>(</span> <span class=n>allowLoadOutsideTransaction</span> <span class=o>)</span> <span class=o>{</span>
				<span class=n>permissiveInitialization</span><span class=o>();</span>
			<span class=o>}</span>
			<span class=k>else</span> <span class=k>if</span> <span class=o>(</span> <span class=n>session</span> <span class=o>==</span> <span class=kc>null</span> <span class=o>)</span> <span class=o>{</span>
				<span class=k>throw</span> <span class=k>new</span> <span class=n>LazyInitializationException</span><span class=o>(</span> <span class=s>&#34;could not initialize proxy [&#34;</span> <span class=o>+</span> <span class=n>entityName</span> <span class=o>+</span> <span class=s>&#34;#&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;] - no Session&#34;</span> <span class=o>);</span>
			<span class=o>}</span>
			<span class=k>else</span> <span class=k>if</span> <span class=o>(</span> <span class=o>!</span><span class=n>session</span><span class=o>.</span><span class=na>isOpen</span><span class=o>()</span> <span class=o>)</span> <span class=o>{</span>
				<span class=k>throw</span> <span class=k>new</span> <span class=n>LazyInitializationException</span><span class=o>(</span> <span class=s>&#34;could not initialize proxy [&#34;</span> <span class=o>+</span> <span class=n>entityName</span> <span class=o>+</span> <span class=s>&#34;#&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;] - the owning Session was closed&#34;</span> <span class=o>);</span>
			<span class=o>}</span>
			<span class=k>else</span> <span class=k>if</span> <span class=o>(</span> <span class=o>!</span><span class=n>session</span><span class=o>.</span><span class=na>isConnected</span><span class=o>()</span> <span class=o>)</span> <span class=o>{</span>
				<span class=k>throw</span> <span class=k>new</span> <span class=n>LazyInitializationException</span><span class=o>(</span> <span class=s>&#34;could not initialize proxy [&#34;</span> <span class=o>+</span> <span class=n>entityName</span> <span class=o>+</span> <span class=s>&#34;#&#34;</span> <span class=o>+</span> <span class=n>id</span> <span class=o>+</span> <span class=s>&#34;] - the owning Session is disconnected&#34;</span> <span class=o>);</span>
			<span class=o>}</span>
			<span class=k>else</span> <span class=o>{</span>
				<span class=n>target</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=na>immediateLoad</span><span class=o>(</span> <span class=n>entityName</span><span class=o>,</span> <span class=n>id</span> <span class=o>);</span>
				<span class=n>initialized</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span>
				<span class=n>checkTargetState</span><span class=o>(</span><span class=n>session</span><span class=o>);</span>
			<span class=o>}</span>
		<span class=o>}</span>
		<span class=k>else</span> <span class=o>{</span>
			<span class=n>checkTargetState</span><span class=o>(</span><span class=n>session</span><span class=o>);</span>
		<span class=o>}</span>
	<span class=o>}</span>
</code></pre></td></tr></table></div></div><p>如果在配置文件中设置了<code>spring.jpa.properties.hibernate.enable_lazy_load_no_trans=true</code>，那么上述的<code>allowLoadOutsideTransaction</code>变量值就为true，则可以进入<code>permissiveInitialization()</code>方法另起session和事务，最终避免懒加载异常<code>LazyInitializationException</code>。如果没有配置该参数，那么就会由于session已关闭（即为null）而抛出<code>LazyInitializationException</code>。</p><h2 id=joincolumn注解无法找回数据导致报错>@JoinColumn注解无法找回数据导致报错</h2><p>使用<code>@JoinColumn</code>时如果无法找到对应的record，就会报错导致查询失败：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-java data-lang=java><span class=n>javax</span><span class=o>.</span><span class=na>persistence</span><span class=o>.</span><span class=na>EntityNotFoundException</span><span class=o>:</span> <span class=n>Unable</span> <span class=n>to</span> <span class=n>find</span> <span class=n>com</span><span class=o>.</span><span class=na>cbxsoftware</span><span class=o>.</span><span class=na>rest</span><span class=o>.</span><span class=na>entity</span><span class=o>.</span><span class=na>fact</span><span class=o>.</span><span class=na>Fact</span> <span class=n>with</span> <span class=n>id</span> <span class=n>4d644cfa243b493ab34d69e4207ee5f1</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>jpa</span><span class=o>.</span><span class=na>boot</span><span class=o>.</span><span class=na>internal</span><span class=o>.</span><span class=na>EntityManagerFactoryBuilderImpl$JpaEntityNotFoundDelegate</span><span class=o>.</span><span class=na>handleEntityNotFound</span><span class=o>(</span><span class=n>EntityManagerFactoryBuilderImpl</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>163</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>AbstractLazyInitializer</span><span class=o>.</span><span class=na>checkTargetState</span><span class=o>(</span><span class=n>AbstractLazyInitializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>286</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>AbstractLazyInitializer</span><span class=o>.</span><span class=na>initialize</span><span class=o>(</span><span class=n>AbstractLazyInitializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>181</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>AbstractLazyInitializer</span><span class=o>.</span><span class=na>getImplementation</span><span class=o>(</span><span class=n>AbstractLazyInitializer</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>310</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>pojo</span><span class=o>.</span><span class=na>bytebuddy</span><span class=o>.</span><span class=na>ByteBuddyInterceptor</span><span class=o>.</span><span class=na>intercept</span><span class=o>(</span><span class=n>ByteBuddyInterceptor</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>45</span><span class=o>)</span>
	<span class=n>at</span> <span class=n>org</span><span class=o>.</span><span class=na>hibernate</span><span class=o>.</span><span class=na>proxy</span><span class=o>.</span><span class=na>ProxyConfiguration$InterceptorDispatcher</span><span class=o>.</span><span class=na>intercept</span><span class=o>(</span><span class=n>ProxyConfiguration</span><span class=o>.</span><span class=na>java</span><span class=o>:</span><span class=n>95</span><span class=o>)</span>
</code></pre></td></tr></table></div></div><p>通过使用hibernate提供的<code>@NotFound(action = NotFoundAction.IGNORE)</code>可以避免这个问题，该注解的默认值是<code>NotFoundAction.EXCEPTION</code>，所以hibernate在join表时查不到对应的数据就会抛出异常。</p><h2 id=参考链接>参考链接</h2><ul><li><a href=https://blog.csdn.net/hsz2568952354/article/details/82724719 target=_blank rel="noopener noreffer">springboot jpa 解决延迟加载问题</a></li><li><a href=https://blog.csdn.net/weixin_43839457/article/details/90445950 target=_blank rel="noopener noreffer">No serializer found for class org.hibernate.proxy.pojo.bytebuddy.ByteBuddyInterceptor</a></li><li><a href=https://blog.csdn.net/liu_yulong/article/details/84594771 target=_blank rel="noopener noreffer">springboot集成jpa返回Json报错 com.fasterxml.jackson.databind.exc.InvalidDefinitionException:</a></li><li><a href=https://www.cnblogs.com/TTTTT/p/6682798.html target=_blank rel="noopener noreffer">Hibernate和Spring整合出现懒加载异常：org.hibernate.LazyInitializationException: could not initialize proxy - no Session</a></li></ul><div class=post-reward><input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label><div class=qr-code><label class=qr-code-image for=reward><img class=image src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/common/wechat.png>
<span>微信打赏</span></label>
<label class=qr-code-image for=reward><img class=image src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/common/alipay.png>
<span>支付宝打赏</span></label></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2021-04-01</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/jpa-hibernate.html/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://lewky.cn/posts/jpa-hibernate.html/ data-title=JPA/Hibernate问题汇总 data-hashtags=JPA,Hibernate,懒加载><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://lewky.cn/posts/jpa-hibernate.html/ data-hashtag=JPA><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 Hacker News" data-sharer=hackernews data-url=https://lewky.cn/posts/jpa-hibernate.html/ data-title=JPA/Hibernate问题汇总><i class="fab fa-hacker-news fa-fw"></i></a><a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://lewky.cn/posts/jpa-hibernate.html/ data-title=JPA/Hibernate问题汇总><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://lewky.cn/posts/jpa-hibernate.html/ data-title=JPA/Hibernate问题汇总><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/jpa/>JPA</a>,&nbsp;<a href=/tags/hibernate/>Hibernate</a>,&nbsp;<a href=/tags/%E6%87%92%E5%8A%A0%E8%BD%BD/>懒加载</a></section><section><span><a href=javascript:void(0); onclick=window.history.back();>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/docsify-0.html/ class=prev rel=prev title=docsify快速入门><i class="fas fa-angle-left fa-fw"></i>docsify快速入门</a></div></div><div id=comments><div id=waline></div><script src=https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js></script><script>new Waline({el:'#waline',meta:["nick","mail","link"],placeholder:"提交评论较慢，请等待几秒~",serverURL:"https://comment.lewky.cn/",avatarCDN:"https://sdn.geekzu.org/avatar/",requiredFields:["nick","mail"],pageSize:10,avatar:"retro",lang:"zh-CN",visitor:true,highlight:true,emojiCDN:'https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/emoji/',emojiMaps:{"good":"weibo/2018new_good_org.png","no way":"weibo/2018new_kuxiao_org.png","smile":"weibo/2018new_weixioa02_org.png","ok":"weibo/2018new_ok_org.png","laugh and cry":"weibo/2018new_xiaoku_thumb.png","doge":"weibo/2018new_doge02_org.png","whee":"weibo/2018new_xixi_thumb.png","happy":"weibo/2018new_taikaixin_org.png","sweat":"weibo/2018new_han_org.png","cat":"weibo/2018new_miaomiao_thumb.png","dog":"weibo/2018new_erha_org.png","lovely":"weibo/2018new_keai_org.png","QQ-0":"qq/0.gif","QQ-1":"qq/1.gif","QQ-3":"qq/3.gif","QQ-6":"qq/6.gif","QQ-10":"qq/10.gif","QQ-12":"qq/12.gif","QQ-13":"qq/13.gif","QQ-26":"qq/26.gif","QQ-31":"qq/31.gif","QQ-37":"qq/37.gif","QQ-71":"qq/71.gif","QQ-72":"qq/72.gif","QQ-74":"qq/74.gif","QQ-85":"qq/85.gif","QQ-146":"qq/146.gif","QQ-147":"qq/147.gif","QQ-148":"qq/148.gif","QQ-149":"qq/149.gif","QQ-150":"qq/150.gif","QQ-151":"qq/151.gif","QQ-152":"qq/152.gif","QQ-153":"qq/153.gif","QQ-154":"qq/154.gif","QQ-155":"qq/155.gif","QQ-172":"qq/172.gif","QQ-207":"qq/207.gif","QQ-jin_li":"qq/jin_li.gif","QQ-zheng_yan":"qq/zheng_yan.gif","aru-1":"aru/1.png","aru-22":"aru/22.png","aru-45":"aru/45.png","aru-47":"aru/47.png","aru-52":"aru/52.png","aru-53":"aru/53.png","aru-54":"aru/54.png","aru-55":"aru/55.png","aru-56":"aru/56.png","aru-57":"aru/57.png","aru-58":"aru/58.png","aru-61":"aru/61.png","aru-100":"aru/100.png","aru-101":"aru/101.png","aru-103":"aru/103.png","aru-104":"aru/104.png","aru-107":"aru/107.png","aru-108":"aru/108.png","aru-110":"aru/110.png","aru-112":"aru/112.png","aru-122":"aru/122.png","aru-123":"aru/123.png","aru-134":"aru/134.png","aru-135":"aru/135.png","aru-144":"aru/144.png","aru-150":"aru/150.png","aru-151":"aru/151.png","aru-152":"aru/152.png","aru-153":"aru/153.png","aru-155":"aru/155.png","aru-156":"aru/156.png","aru-160":"aru/160.png","aru-162":"aru/162.png","aru-164":"aru/164.png","aru-166":"aru/166.png","aru-167":"aru/167.png","aru-168":"aru/168.png","aru-170":"aru/170.png","aru-171":"aru/171.png","aru-172":"aru/172.png","aru-173":"aru/173.png","aru-174":"aru/174.png","aru-175":"aru/175.png","aru-176":"aru/176.png","aru-178":"aru/178.png","aru-213":"aru/213.png","aru-240":"aru/240.png","aru-241":"aru/241.png","aru-249":"aru/249.png","aru-257":"aru/257.png","aru-258":"aru/258.png","aru-259":"aru/259.png","aru-265":"aru/265.png","aru-266":"aru/266.png","aru-267":"aru/267.png","aru-285":"aru/285.png","aru-286":"aru/286.png","aru-287":"aru/287.png","aru-288":"aru/288.png","aru-295":"aru/295.png","aru-296":"aru/296.png","aru-297":"aru/297.png","aru-298":"aru/298.png","aru-299":"aru/299.png","aru-300":"aru/300.png","aru-301":"aru/301.png","aru-302":"aru/302.png","aru-303":"aru/303.png","aru-304":"aru/304.png","aru-305":"aru/305.png","aru-306":"aru/306.png","bilibili_2233-卖萌":"bilibili_2233/卖萌.png","bilibili_2233-吃惊":"bilibili_2233/吃惊.png","bilibili_2233-吐魂":"bilibili_2233/吐魂.png","bilibili_2233-喝水":"bilibili_2233/喝水.png","bilibili_2233-困惑":"bilibili_2233/困惑.png","bilibili_2233-大哭":"bilibili_2233/大哭.png","bilibili_2233-大笑":"bilibili_2233/大笑.png","bilibili_2233-委屈":"bilibili_2233/委屈.png","bilibili_2233-怒":"bilibili_2233/怒.png","bilibili_2233-无言":"bilibili_2233/无言.png","bilibili_2233-汗":"bilibili_2233/汗.png","bilibili_2233-疑问":"bilibili_2233/疑问.png","bilibili_2233-第一":"bilibili_2233/第一.png","bilibili_2233-耶":"bilibili_2233/耶.png","bilibili_2233-郁闷":"bilibili_2233/郁闷.png","bilibili_tv_gif-doge":"bilibili_tv_gif/doge.gif","bilibili_tv_gif-亲亲":"bilibili_tv_gif/亲亲.gif","bilibili_tv_gif-偷笑":"bilibili_tv_gif/偷笑.gif","bilibili_tv_gif-再见":"bilibili_tv_gif/再见.gif","bilibili_tv_gif-发怒":"bilibili_tv_gif/发怒.gif","bilibili_tv_gif-发财":"bilibili_tv_gif/发财.gif","bilibili_tv_gif-可爱":"bilibili_tv_gif/可爱.gif","bilibili_tv_gif-吐血":"bilibili_tv_gif/吐血.gif","bilibili_tv_gif-呆":"bilibili_tv_gif/呆.gif","bilibili_tv_gif-呕吐":"bilibili_tv_gif/呕吐.gif","bilibili_tv_gif-困":"bilibili_tv_gif/困.gif","bilibili_tv_gif-坏笑":"bilibili_tv_gif/坏笑.gif","bilibili_tv_gif-大佬":"bilibili_tv_gif/大佬.gif","bilibili_tv_gif-大哭":"bilibili_tv_gif/大哭.gif","bilibili_tv_gif-委屈":"bilibili_tv_gif/委屈.gif","bilibili_tv_gif-害羞":"bilibili_tv_gif/害羞.gif","bilibili_tv_gif-尴尬":"bilibili_tv_gif/尴尬.gif","bilibili_tv_gif-微笑":"bilibili_tv_gif/微笑.gif","bilibili_tv_gif-思考":"bilibili_tv_gif/思考.gif","bilibili_tv_gif-惊吓":"bilibili_tv_gif/惊吓.gif","bilibili_tv_gif-打脸":"bilibili_tv_gif/打脸.gif","bilibili_tv_gif-抓狂":"bilibili_tv_gif/抓狂.gif","bilibili_tv_gif-抠鼻子":"bilibili_tv_gif/抠鼻子.gif","bilibili_tv_gif-斜眼笑":"bilibili_tv_gif/斜眼笑.gif","bilibili_tv_gif-无奈":"bilibili_tv_gif/无奈.gif","bilibili_tv_gif-晕":"bilibili_tv_gif/晕.gif","bilibili_tv_gif-流汗":"bilibili_tv_gif/流汗.gif","bilibili_tv_gif-流鼻血":"bilibili_tv_gif/流鼻血.gif","bilibili_tv_gif-点赞":"bilibili_tv_gif/点赞.gif","bilibili_tv_gif-生气":"bilibili_tv_gif/生气.gif","bilibili_tv_gif-生病":"bilibili_tv_gif/生病.gif","bilibili_tv_gif-疑问":"bilibili_tv_gif/疑问.gif","bilibili_tv_gif-白眼":"bilibili_tv_gif/白眼.gif","bilibili_tv_gif-睡着":"bilibili_tv_gif/睡着.gif","bilibili_tv_gif-笑哭":"bilibili_tv_gif/笑哭.gif","bilibili_tv_gif-腼腆":"bilibili_tv_gif/腼腆.gif","bilibili_tv_gif-色":"bilibili_tv_gif/色.gif","bilibili_tv_gif-调皮":"bilibili_tv_gif/调皮.gif","bilibili_tv_gif-鄙视":"bilibili_tv_gif/鄙视.gif","bilibili_tv_gif-闭嘴":"bilibili_tv_gif/闭嘴.gif","bilibili_tv_gif-难过":"bilibili_tv_gif/难过.gif","bilibili_tv_gif-馋":"bilibili_tv_gif/馋.gif","bilibili_tv_gif-黑人问号":"bilibili_tv_gif/黑人问号.gif","bilibili_tv_gif-鼓掌":"bilibili_tv_gif/鼓掌.gif","滑稽-001":"滑稽/001.jpg","滑稽-002":"滑稽/002.jpg","滑稽-003":"滑稽/003.jpg","滑稽-004":"滑稽/004.jpg","滑稽-005":"滑稽/005.jpg","滑稽-006":"滑稽/006.jpg","滑稽-007":"滑稽/007.jpg","滑稽-008":"滑稽/008.jpg","滑稽-009":"滑稽/009.jpg","滑稽-010":"滑稽/010.jpg","滑稽-011":"滑稽/011.jpg","滑稽-012":"滑稽/012.jpg","滑稽-013":"滑稽/013.jpg","滑稽-014":"滑稽/014.jpg","滑稽-015":"滑稽/015.jpg","滑稽-016":"滑稽/016.jpg","滑稽-017":"滑稽/017.jpg","滑稽-018":"滑稽/018.jpg","滑稽-019":"滑稽/019.jpg","滑稽-020":"滑稽/020.jpg","滑稽-021":"滑稽/021.jpg","滑稽-022":"滑稽/022.jpg","滑稽-023":"滑稽/023.jpg","滑稽-024":"滑稽/024.jpg","滑稽-025":"滑稽/025.jpg","滑稽-026":"滑稽/026.jpg","滑稽-027":"滑稽/027.jpg","滑稽-028":"滑稽/028.jpg","滑稽-029":"滑稽/029.jpg","滑稽-030":"滑稽/030.jpg","滑稽-031":"滑稽/031.jpg","滑稽-032":"滑稽/032.jpg","滑稽-033":"滑稽/033.jpg","滑稽-034":"滑稽/034.jpg","滑稽-035":"滑稽/035.jpg","滑稽-036":"滑稽/036.jpg","滑稽-037":"滑稽/037.jpg","滑稽-038":"滑稽/038.jpg","滑稽-039":"滑稽/039.jpg","滑稽-040":"滑稽/040.jpg","滑稽-041":"滑稽/041.jpg","滑稽-042":"滑稽/042.jpg","滑稽-043":"滑稽/043.jpg","滑稽-044":"滑稽/044.jpg","滑稽-045":"滑稽/045.jpg","滑稽-046":"滑稽/046.jpg","滑稽-047":"滑稽/047.jpg","default-01":"default/01.webp","default-010":"default/010.webp","default-011":"default/011.webp","default-012":"default/012.webp","default-013":"default/013.webp","default-014":"default/014.webp","default-016":"default/016.webp","default-017":"default/017.webp","default-018":"default/018.jpg","default-019":"default/019.webp","default-02":"default/02.webp","default-020":"default/020.webp","default-021":"default/021.webp","default-022":"default/022.webp","default-023":"default/023.webp","default-024":"default/024.webp","default-025":"default/025.jpg","default-026":"default/026.webp","default-027":"default/027.webp","default-028":"default/028.webp","default-029":"default/029.webp","default-03":"default/03.jpg","default-030":"default/030.gif","default-031":"default/031.webp","default-04":"default/04.jpg","default-05":"default/05.gif","default-06":"default/06.gif","default-07":"default/07.webp","default-08":"default/08.webp","default-09":"default/09.webp"}});</script></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2018 - 2021</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>雨临Lewis</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a target=_blank href=http://www.beian.miit.gov.cn/ style=font-weight:700>粤ICP备19103822</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=sidebar_wo><div id=leimu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover="this.src='https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/b2t/leimuB.png'" onmouseout="this.src='https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/b2t/leimuA.png'" title=回到顶部></div><div class=sidebar_wo id=lamu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover="this.src='https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/b2t/lamuB.png'" onmouseout="this.src='https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/b2t/lamuA.png'" title=回到底部></div></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":15},"comment":{},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true}};</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js></script><script>$(function(){$(".site-avatar-plug-bilibili").attr("src","https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/avatar-plug/bilibili_"+(~~(128*Math.random())+1)+".png");});var avatar_plug=0;var avatar_click=1;jQuery(document).ready(function($){var frequency=1;var plug_count=128;$("div.home-avatar a").click(function(e){if(avatar_click%frequency===0){avatar_plug++;$(".site-avatar-plug-bilibili").attr("src","https:\/\/cdn.jsdelivr.net\/gh\/lewky\/lewky.github.io@master/images/avatar-plug/bilibili_"+avatar_plug+".png");}
if(avatar_plug===plug_count){avatar_plug=0;}
$("div.home-avatar a").attr("alt","再点击"+(frequency-avatar_click%frequency)+"次头像试试看~~");avatar_click++;});});</script><script>var $cdnPrefix="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master";</script><script type=text/javascript src=/js/custom.js></script><script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?6f278ed0fdb01edb3b1e7398379e5432";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();</script><div class="GalMenu GalDropDown"><div class=circle id=gal><div class=ring><a href=/ target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu1.jpg) class=menuItem>首页</a><a href=/funny/mikutap/ target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu2.jpg) class=menuItem>音乐游戏</a><a href=/funny/high/ target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu3.jpg) class=menuItem>前方高能</a><a href=/posts/e62c38c4.html target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu4.jpg) class=menuItem>建站日志</a><a href=/posts/d65a1577.html target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu5.jpg) class=menuItem>随笔</a><a href=/friends/ target=_blank style=background-image:url(https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/rightmenu/rightmenu6.jpg) class=menuItem>友链</a></div><audio id=audio src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/audio/niconiconi.mp3></audio></div></div><script type=text/javascript>var items=document.querySelectorAll('.menuItem');for(var i=0,l=items.length;i<l;i++){items[i].style.left=(50-35*Math.cos(-0.5*Math.PI-2*(1/l)*i*Math.PI)).toFixed(4)+"%";items[i].style.top=(50+35*Math.sin(-0.5*Math.PI-2*(1/l)*i*Math.PI)).toFixed(4)+"%"}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/css/GalMenu.css><script type=text/javascript src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/js/GalMenu.js></script><script type=text/javascript>$(document).ready(function(){$('body').GalMenu({'menu':'GalDropDown'})});</script></body></html>